<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>clj-headlights.pipeline documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-headlights</span> <span class="project-version">master-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-headlights</span></div></div></li><li class="depth-2 branch"><a href="clj-headlights.bigquery-io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bigquery-io</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.bigtable-io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bigtable-io</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.clj-fn-call.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-fn-call</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.input-output.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>input-output</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.nippy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nippy</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.pardo.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pardo</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.pcollections.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pcollections</span></div></a></li><li class="depth-2 branch current"><a href="clj-headlights.pipeline.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pipeline</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.pubsub.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pubsub</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.system.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>system</span></div></a></li><li class="depth-2 branch"><a href="clj-headlights.test-helpers.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test-helpers</span></div></a></li><li class="depth-2"><a href="clj-headlights.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clj-headlights.pipeline.html#var-apply-to-value-and-output"><div class="inner"><span>apply-to-value-and-output</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-apply-to-value-and-output-kv"><div class="inner"><span>apply-to-value-and-output-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-apply-to-value-and-output-with-timestamp"><div class="inner"><span>apply-to-value-and-output-with-timestamp</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-apply-to-value-and-seq-outputs"><div class="inner"><span>apply-to-value-and-seq-outputs</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-apply-to-value-and-seq-outputs-kv"><div class="inner"><span>apply-to-value-and-seq-outputs-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-co-group-by-key"><div class="inner"><span>co-group-by-key</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-composite"><div class="inner"><span>composite</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-context-.3Ems"><div class="inner"><span>context-&gt;ms</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-create"><div class="inner"><span>create</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-apply-dofn"><div class="inner"><span>df-apply-dofn</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-filter"><div class="inner"><span>df-filter</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-filter-kv"><div class="inner"><span>df-filter-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-map"><div class="inner"><span>df-map</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-map-cat-with-side-outputs"><div class="inner"><span>df-map-cat-with-side-outputs</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-map-kv"><div class="inner"><span>df-map-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-map-with-side-input"><div class="inner"><span>df-map-with-side-input</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-map-with-timestamp"><div class="inner"><span>df-map-with-timestamp</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-mapcat"><div class="inner"><span>df-mapcat</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-df-mapcat-kv"><div class="inner"><span>df-mapcat-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-filterer"><div class="inner"><span>filterer</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-filterer-kv"><div class="inner"><span>filterer-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-flatten-pcollections"><div class="inner"><span>flatten-pcollections</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-get-side-output"><div class="inner"><span>get-side-output</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-get-side-outputs"><div class="inner"><span>get-side-outputs</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-group-by-key"><div class="inner"><span>group-by-key</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-make-pipeline-options"><div class="inner"><span>make-pipeline-options</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-output-is-kv"><div class="inner"><span>output-is-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-process-pcoll"><div class="inner"><span>process-pcoll</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-process-pcoll-kv"><div class="inner"><span>process-pcoll-kv</span></div></a></li><li class="depth-1"><a href="clj-headlights.pipeline.html#var-side-output-function-wrapper"><div class="inner"><span>side-output-function-wrapper</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">clj-headlights.pipeline</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-apply-to-value-and-output"><h3>apply-to-value-and-output</h3><div class="usage"><code>(apply-to-value-and-output context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L63">view source</a></div></div><div class="public anchor" id="var-apply-to-value-and-output-kv"><h3>apply-to-value-and-output-kv</h3><div class="usage"><code>(apply-to-value-and-output-kv context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L112">view source</a></div></div><div class="public anchor" id="var-apply-to-value-and-output-with-timestamp"><h3>apply-to-value-and-output-with-timestamp</h3><div class="usage"><code>(apply-to-value-and-output-with-timestamp context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L161">view source</a></div></div><div class="public anchor" id="var-apply-to-value-and-seq-outputs"><h3>apply-to-value-and-seq-outputs</h3><div class="usage"><code>(apply-to-value-and-seq-outputs context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L87">view source</a></div></div><div class="public anchor" id="var-apply-to-value-and-seq-outputs-kv"><h3>apply-to-value-and-seq-outputs-kv</h3><div class="usage"><code>(apply-to-value-and-seq-outputs-kv context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L133">view source</a></div></div><div class="public anchor" id="var-co-group-by-key"><h3>co-group-by-key</h3><div class="usage"><code>(co-group-by-key pcolls name)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcolls :- (s/cond-pre PCollection [PCollection]) name :- s/Str] Returns: PCollection</p>
<p>Takes a list of PCollections which are already in KV form, and joins them on their keys. Output pcollection will look like: [key [first-pcoll-vals second-pcoll-vals third-pcoll-vals &amp;c]]</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L182">view source</a></div></div><div class="public anchor" id="var-composite"><h3>composite</h3><div class="usage"><code>(composite name inputs f)</code></div><div class="doc"><div class="markdown"><p>Inputs: [name :- s/Str inputs :- [pcollections/PCollectionType] f :- IFn]</p>
<p>Nests transforms that happen in f into a composite transform</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L200">view source</a></div></div><div class="public anchor" id="var-context-.3Ems"><h3>context-&gt;ms</h3><div class="usage"><code>(context-&gt;ms c)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L223">view source</a></div></div><div class="public anchor" id="var-create"><h3>create</h3><div class="usage"><code>(create options)</code></div><div class="doc"><div class="markdown"><p>Inputs: [options :- PipelineOptions] Returns: Pipeline</p>
<p>Create a Pipeline object. This is the first building block of any Beam pipeline.</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L25">view source</a></div></div><div class="public anchor" id="var-df-apply-dofn"><h3>df-apply-dofn</h3><div class="usage"><code>(df-apply-dofn pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll name clj-call]</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L146">view source</a></div></div><div class="public anchor" id="var-df-filter"><h3>df-filter</h3><div class="usage"><code>(df-filter pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall] Returns: PCollection</p>
<p>Returns a <code>PCollection</code> containing the elements of <code>pcoll</code> where <code>(f element)</code> is truthy</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L105">view source</a></div></div><div class="public anchor" id="var-df-filter-kv"><h3>df-filter-kv</h3><div class="usage"><code>(df-filter-kv pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall] Returns: PCollection</p>
<p>returns a <code>PCollection</code> containing the elements of <code>pcoll</code> where <code>(f element)</code> is true. coerces to KV</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L154">view source</a></div></div><div class="public anchor" id="var-df-map"><h3>df-map</h3><div class="usage"><code>(df-map pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall] Returns: PCollection</p>
<p>Returns a <code>PCollection</code> of the return values of function <code>clj-call</code> being applied to the input <code>pcoll</code> - used for strictly 1-to-1 transformations</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L68">view source</a></div></div><div class="public anchor" id="var-df-map-cat-with-side-outputs"><h3>df-map-cat-with-side-outputs</h3><div class="usage"><code>(df-map-cat-with-side-outputs pcoll name clj-call tags)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall tags :- [s/Keyword]] Returns: PCollectionTuple</p>
<p>Acts like a map-cat but returns a <code>PCollectionTuple</code> partitioned by the tag of the outputs of <code>f</code>. <code>f</code> must return a sequence of tuples in the form <code>[:tag value]</code>. The main output should use the tag <code>:main</code>. Nil values are filtered out</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L42">view source</a></div></div><div class="public anchor" id="var-df-map-kv"><h3>df-map-kv</h3><div class="usage"><code>(df-map-kv pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall]</p>
<p>Same as df-map but expects the output of <code>f</code> to be a sequence of length 2 which is converted to a Dataflow KV object. Mostly used before a <code>GroupBy</code></p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L125">view source</a></div></div><div class="public anchor" id="var-df-map-with-side-input"><h3>df-map-with-side-input</h3><div class="usage"><code>(df-map-with-side-input pcoll name side-input-view clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str side-input-view clj-call :- clj-fn-call/CljCall] Returns: PCollection</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L76">view source</a></div></div><div class="public anchor" id="var-df-map-with-timestamp"><h3>df-map-with-timestamp</h3><div class="usage"><code>(df-map-with-timestamp pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall]</p>
<p>Assigns a timestamp to pcoll rows</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L166">view source</a></div></div><div class="public anchor" id="var-df-mapcat"><h3>df-mapcat</h3><div class="usage"><code>(df-mapcat pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall] Returns: PCollection</p>
<p>Similar to <code>df-map</code> but the return-values of <code>f</code> are flattened in the output <code>PCollection</code> - used when the transformation is not strictly 1-to-1</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L92">view source</a></div></div><div class="public anchor" id="var-df-mapcat-kv"><h3>df-mapcat-kv</h3><div class="usage"><code>(df-mapcat-kv pcoll name clj-call)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- pcollections/PCollectionType name :- s/Str clj-call :- clj-fn-call/CljCall]</p>
<p>Same as <code>df-map-kv</code> except <code>f</code> returns a sequence of lenght-2-sequences to be flattened and converted into KV objects</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L138">view source</a></div></div><div class="public anchor" id="var-filterer"><h3>filterer</h3><div class="usage"><code>(filterer context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L100">view source</a></div></div><div class="public anchor" id="var-filterer-kv"><h3>filterer-kv</h3><div class="usage"><code>(filterer-kv context value _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L149">view source</a></div></div><div class="public anchor" id="var-flatten-pcollections"><h3>flatten-pcollections</h3><div class="usage"><code>(flatten-pcollections pcolls name)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcolls :- [PCollection] name :- s/Str] Returns: PCollection</p>
<p>Merge a list of pcolls.</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L175">view source</a></div></div><div class="public anchor" id="var-get-side-output"><h3>get-side-output</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L22">view source</a></div></div><div class="public anchor" id="var-get-side-outputs"><h3>get-side-outputs</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L23">view source</a></div></div><div class="public anchor" id="var-group-by-key"><h3>group-by-key</h3><div class="usage"><code>(group-by-key pcoll name)</code></div><div class="doc"><div class="markdown"><p>Inputs: [pcoll :- PCollection name :- s/Str] Returns: PCollection</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L195">view source</a></div></div><div class="public anchor" id="var-make-pipeline-options"><h3>make-pipeline-options</h3><div class="usage"><code>(make-pipeline-options)</code></div><div class="doc"><div class="markdown"><p>Inputs: [] Returns: PipelineOptions</p>
<p>Create a PipelineOptions object.</p></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L30">view source</a></div></div><div class="public anchor" id="var-output-is-kv"><h3>output-is-kv</h3><div class="usage"><code>(output-is-kv pcoll)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L173">view source</a></div></div><div class="public anchor" id="var-process-pcoll"><h3>process-pcoll</h3><div class="usage"><code>(process-pcoll pcoll name wrapping-call clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L56">view source</a></div></div><div class="public anchor" id="var-process-pcoll-kv"><h3>process-pcoll-kv</h3><div class="usage"><code>(process-pcoll-kv pcoll name wrapping-call clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L117">view source</a></div></div><div class="public anchor" id="var-side-output-function-wrapper"><h3>side-output-function-wrapper</h3><div class="usage"><code>(side-output-function-wrapper context val _window state clj-call)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/logrhythm-oss/clj-headlights/blob/master/src/clj_headlights/pipeline.clj#L35">view source</a></div></div></div></body></html>